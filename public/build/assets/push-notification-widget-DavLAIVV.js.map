{"version":3,"file":"push-notification-widget-DavLAIVV.js","sources":["../../../resources/js/push-notification-widget.js"],"sourcesContent":["console.log('[PushWidget] script loaded');\r\nconsole.log('[PushWidget] Checking environment...');\r\nconsole.log('[PushWidget] - Alpine.js available:', typeof window.Alpine !== 'undefined');\r\nconsole.log('[PushWidget] - Document ready state:', document.readyState);\r\nconsole.log('[PushWidget] - Service Worker support:', 'serviceWorker' in navigator);\r\nconsole.log('[PushWidget] - Push Manager support:', 'PushManager' in window);\r\n\r\nfunction pushNotificationWidget() {\r\n    return {\r\n        VAPID_PUBLIC_KEY: '',\r\n        elements: {},\r\n        sections: {},\r\n        controls: {},\r\n\r\n        initWidget() {\r\n            const widgetContainer = this.$el;\r\n            this.VAPID_PUBLIC_KEY = widgetContainer.dataset.vapidKey || '';\r\n            \r\n            // DIAGNOSTIC: Log VAPID key availability\r\n            console.log('[DIAGNOSTIC] VAPID Key Length:', this.VAPID_PUBLIC_KEY.length);\r\n            console.log('[DIAGNOSTIC] VAPID Key (first 20 chars):', this.VAPID_PUBLIC_KEY.substring(0, 20));\r\n            if (!this.VAPID_PUBLIC_KEY || this.VAPID_PUBLIC_KEY.length === 0) {\r\n                console.error('[DIAGNOSTIC] ‚ùå CRITICAL: VAPID_PUBLIC_KEY is EMPTY or MISSING!');\r\n                console.error('[DIAGNOSTIC] Push notifications cannot work without a valid VAPID key');\r\n                console.error('[DIAGNOSTIC] Check .env file for VAPID_PUBLIC_KEY variable');\r\n            } else {\r\n                console.log('[DIAGNOSTIC] ‚úÖ VAPID key is present');\r\n            }\r\n\r\n            // Cache DOM elements - separate sections from controls\r\n            this.sections = {\r\n                loading: widgetContainer.querySelector('#push-loading'),\r\n                iosPrompt: widgetContainer.querySelector('#ios-prompt'),\r\n                notSupported: widgetContainer.querySelector('#not-supported'),\r\n                permissionDenied: widgetContainer.querySelector('#permission-denied'),\r\n                subscribeSection: widgetContainer.querySelector('#subscribe-section'),\r\n                subscribedSection: widgetContainer.querySelector('#subscribed-section'),\r\n                errorSection: widgetContainer.querySelector('#error-section'),\r\n            };\r\n\r\n            this.controls = {\r\n                errorMessage: widgetContainer.querySelector('#error-message'),\r\n                subscribeBtn: widgetContainer.querySelector('#subscribe-btn'),\r\n                unsubscribeBtn: widgetContainer.querySelector('#unsubscribe-btn'),\r\n                testNotificationBtn: widgetContainer.querySelector('#test-notification-btn'),\r\n            };\r\n\r\n            // Keep elements for backward compatibility\r\n            this.elements = { ...this.sections, ...this.controls };\r\n\r\n            // Setup event listeners\r\n            if (this.controls.subscribeBtn) {\r\n                this.controls.subscribeBtn.addEventListener('click', () => this.subscribe());\r\n            }\r\n            if (this.controls.unsubscribeBtn) {\r\n                this.controls.unsubscribeBtn.addEventListener('click', () => this.unsubscribe());\r\n            }\r\n            if (this.controls.testNotificationBtn) {\r\n                this.controls.testNotificationBtn.addEventListener('click', () => this.sendTestNotification());\r\n            }\r\n\r\n            // Initialize - Register service worker first, then check status\r\n            (async () => {\r\n                console.log('[PushWidget] Initializing push notification widget...');\r\n                await this.registerServiceWorker();\r\n                this.checkStatus();\r\n            })();\r\n        },\r\n\r\n        hideAllSections() {\r\n            Object.values(this.sections).forEach(el => {\r\n                if (el && el.classList) el.classList.add('hidden');\r\n            });\r\n        },\r\n\r\n        hideAll() {\r\n            Object.values(this.elements).forEach(el => {\r\n                if (el && el.classList) el.classList.add('hidden');\r\n            });\r\n        },\r\n\r\n        show(element) {\r\n            if (element) element.classList.remove('hidden');\r\n        },\r\n\r\n        isIOS() {\r\n            return /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\r\n        },\r\n\r\n        isStandalone() {\r\n            return window.navigator.standalone === true ||\r\n                   window.matchMedia('(display-mode: standalone)').matches;\r\n        },\r\n\r\n        urlBase64ToUint8Array(base64String) {\r\n            const padding = '='.repeat((4 - base64String.length % 4) % 4);\r\n            const base64 = (base64String + padding).replace(/-/g, '+').replace(/_/g, '/');\r\n            const rawData = window.atob(base64);\r\n            const outputArray = new Uint8Array(rawData.length);\r\n            for (let i = 0; i < rawData.length; ++i) {\r\n                outputArray[i] = rawData.charCodeAt(i);\r\n            }\r\n            return outputArray;\r\n        },\r\n\r\n        // Service Worker Registration\r\n        async registerServiceWorker() {\r\n            if ('serviceWorker' in navigator) {\r\n                try {\r\n                    console.log('[PushWidget] Attempting to register service worker...');\r\n                    console.log('[DIAGNOSTIC] Service worker file: /sw.js');\r\n                    console.log('[DIAGNOSTIC] Service worker scope: /');\r\n                    console.log('[DIAGNOSTIC] Current URL:', window.location.href);\r\n                    console.log('[DIAGNOSTIC] Is HTTPS?:', window.location.protocol === 'https:');\r\n                    \r\n                    const registration = await navigator.serviceWorker.register('/sw.js', { scope: '/' });\r\n                    console.log('[PushWidget] Service Worker registered successfully with scope:', registration.scope);\r\n                    console.log('[DIAGNOSTIC] ‚úÖ Service Worker registration successful');\r\n                    console.log('[DIAGNOSTIC] Registration state:', registration.active?.state || 'installing/waiting');\r\n                    \r\n                    return registration;\r\n                } catch (error) {\r\n                    console.error('[PushWidget] Service Worker registration failed:', error);\r\n                    console.error('[DIAGNOSTIC] ‚ùå Service Worker registration error details:', error.name, error.message);\r\n                    console.error('[DIAGNOSTIC] This could be due to: HTTPS requirement, file not found, or scope issues');\r\n                    return null;\r\n                }\r\n            }\r\n            console.log('[PushWidget] Service workers are not supported in this browser');\r\n            console.error('[DIAGNOSTIC] ‚ùå Service workers not supported in this browser');\r\n            return null;\r\n        },\r\n\r\n        async checkStatus() {\r\n            this.hideAllSections();\r\n\r\n            // Check basic support\r\n            if (!('serviceWorker' in navigator) || !('PushManager' in window)) {\r\n                console.log('[PushWidget] Push not supported in this browser');\r\n                this.show(this.sections.notSupported);\r\n                return;\r\n            }\r\n\r\n            // iOS specific handling\r\n            if (this.isIOS() && !this.isStandalone()) {\r\n                console.log('[PushWidget] iOS device not in standalone mode');\r\n                this.show(this.sections.iosPrompt);\r\n                return;\r\n            }\r\n\r\n            // Check permission\r\n            if (Notification.permission === 'denied') {\r\n                console.log('[PushWidget] Notification permission denied');\r\n                this.show(this.sections.permissionDenied);\r\n                return;\r\n            }\r\n\r\n            // Check existing subscription with timeout fallback\r\n            try {\r\n                console.log('[PushWidget] Checking service worker ready status with 5s timeout...');\r\n                // Wait for service worker with 5 second timeout\r\n                const registration = await Promise.race([\r\n                    navigator.serviceWorker.ready,\r\n                    new Promise((_, reject) =>\r\n                        setTimeout(() => reject(new Error('Service worker ready timeout')), 5000)\r\n                    )\r\n                ]);\r\n\r\n                console.log('[PushWidget] Service worker ready, checking subscription...');\r\n                const subscription = await registration.pushManager.getSubscription();\r\n\r\n                if (subscription) {\r\n                    console.log('[PushWidget] User is subscribed');\r\n                    this.show(this.sections.subscribedSection);\r\n                } else {\r\n                    console.log('[PushWidget] User not subscribed, show subscribe button');\r\n                    this.show(this.sections.subscribeSection);\r\n                }\r\n            } catch (error) {\r\n                console.log('[PushWidget] Service worker not ready or timeout, attempting registration...');\r\n                // If service worker not registered, register it\r\n                const newReg = await this.registerServiceWorker();\r\n                if (newReg) {\r\n                    // Try again after registration\r\n                    console.log('[PushWidget] Service worker registered, retrying status check...');\r\n                    setTimeout(() => this.checkStatus(), 500);\r\n                    return;\r\n                }\r\n                console.error('[PushWidget] Could not register service worker:', error);\r\n                this.hideAllSections();\r\n                this.show(this.sections.errorSection);\r\n                this.controls.errorMessage.textContent = 'Could not register service worker: ' + error.message;\r\n            }\r\n        },\r\n\r\n        async subscribe() {\r\n            try {\r\n                console.log('[PushWidget] Starting subscription process...');\r\n                console.log('[DIAGNOSTIC] üìù Subscription Diagnostics:');\r\n                console.log('[DIAGNOSTIC] - Browser:', navigator.userAgent);\r\n                console.log('[DIAGNOSTIC] - Service Worker support:', 'serviceWorker' in navigator);\r\n                console.log('[DIAGNOSTIC] - Push Manager support:', 'PushManager' in window);\r\n                console.log('[DIAGNOSTIC] - Notification permission:', Notification.permission);\r\n                console.log('[DIAGNOSTIC] - VAPID key present:', !!this.VAPID_PUBLIC_KEY);\r\n                console.log('[DIAGNOSTIC] - VAPID key length:', this.VAPID_PUBLIC_KEY.length);\r\n                \r\n                this.controls.subscribeBtn.disabled = true;\r\n                this.controls.subscribeBtn.textContent = 'Enabling...';\r\n\r\n                // Request notification permission first (required for iOS and best practice)\r\n                if (Notification.permission === 'default') {\r\n                    console.log('[PushWidget] Requesting notification permission...');\r\n                    console.log('[DIAGNOSTIC] Showing browser permission prompt...');\r\n                    const permission = await Notification.requestPermission();\r\n                    console.log('[PushWidget] Permission result:', permission);\r\n                    console.log('[DIAGNOSTIC] Permission granted:', permission === 'granted');\r\n                    if (permission !== 'granted') {\r\n                        throw new Error('Notification permission not granted: ' + permission);\r\n                    }\r\n                }\r\n\r\n                if (Notification.permission !== 'granted') {\r\n                    throw new Error('Notification permission not granted');\r\n                }\r\n\r\n                console.log('[DIAGNOSTIC] Waiting for service worker to be ready...');\r\n                const registration = await navigator.serviceWorker.ready;\r\n                console.log('[DIAGNOSTIC] ‚úÖ Service worker ready');\r\n\r\n                console.log('[DIAGNOSTIC] Attempting to subscribe with VAPID key...');\r\n                console.log('[DIAGNOSTIC] VAPID key (first 30 chars):', this.VAPID_PUBLIC_KEY.substring(0, 30));\r\n                const subscription = await registration.pushManager.subscribe({\r\n                    userVisibleOnly: true,\r\n                    applicationServerKey: this.urlBase64ToUint8Array(this.VAPID_PUBLIC_KEY)\r\n                });\r\n                console.log('[DIAGNOSTIC] ‚úÖ Browser subscription created successfully');\r\n\r\n                console.log('[PushWidget] Push subscription created, sending to server...');\r\n                console.log('[DIAGNOSTIC] Subscription endpoint:', subscription.endpoint.substring(0, 50) + '...');\r\n\r\n                // Send to server\r\n                const response = await fetch('/api/push-subscriptions', {\r\n                    method: 'POST',\r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                        'Accept': 'application/json',\r\n                        'X-CSRF-TOKEN': document.querySelector('meta[name=\"csrf-token\"]')?.content || ''\r\n                    },\r\n                    credentials: 'same-origin',\r\n                    body: JSON.stringify(subscription.toJSON())\r\n                });\r\n\r\n                console.log('[DIAGNOSTIC] Server response status:', response.status);\r\n                console.log('[DIAGNOSTIC] Server response ok:', response.ok);\r\n                \r\n                if (!response.ok) {\r\n                    const errorText = await response.text();\r\n                    console.error('[DIAGNOSTIC] ‚ùå Server error response:', errorText);\r\n                    throw new Error('Failed to save subscription. Status: ' + response.status);\r\n                }\r\n                \r\n                const responseData = await response.json();\r\n                console.log('[DIAGNOSTIC] ‚úÖ Server response:', responseData);\r\n\r\n                console.log('[PushWidget] Subscription saved successfully');\r\n                this.hideAllSections();\r\n                this.show(this.sections.subscribedSection);\r\n            } catch (error) {\r\n                console.error('[PushWidget] Subscription error:', error);\r\n                this.hideAllSections();\r\n                this.show(this.sections.errorSection);\r\n                this.controls.errorMessage.textContent = 'Failed to enable notifications: ' + error.message;\r\n            } finally {\r\n                if (this.controls.subscribeBtn) {\r\n                    this.controls.subscribeBtn.disabled = false;\r\n                    this.controls.subscribeBtn.textContent = 'Enable Push Notifications';\r\n                }\r\n            }\r\n        },\r\n\r\n        async unsubscribe() {\r\n            try {\r\n                console.log('[PushWidget] Unsubscribing...');\r\n                const registration = await navigator.serviceWorker.ready;\r\n                const subscription = await registration.pushManager.getSubscription();\r\n\r\n                if (subscription) {\r\n                    await subscription.unsubscribe();\r\n                    console.log('[PushWidget] Unsubscribed locally, notifying server...');\r\n\r\n                    // Notify server\r\n                    await fetch('/api/push-subscriptions', {\r\n                        method: 'DELETE',\r\n                        headers: {\r\n                            'Content-Type': 'application/json',\r\n                            'Accept': 'application/json',\r\n                            'X-CSRF-TOKEN': document.querySelector('meta[name=\"csrf-token\"]')?.content || ''\r\n                        },\r\n                        credentials: 'same-origin',\r\n                        body: JSON.stringify({ endpoint: subscription.endpoint })\r\n                    });\r\n                }\r\n\r\n                console.log('[PushWidget] Unsubscription complete');\r\n                this.hideAllSections();\r\n                this.show(this.sections.subscribeSection);\r\n            } catch (error) {\r\n                console.error('[PushWidget] Unsubscribe error:', error);\r\n            }\r\n        },\r\n\r\n        async sendTestNotification() {\r\n            try {\r\n                console.log('[PushWidget] Sending test notification...');\r\n                if (this.controls.testNotificationBtn) {\r\n                    this.controls.testNotificationBtn.disabled = true;\r\n                    this.controls.testNotificationBtn.textContent = 'Sending...';\r\n                }\r\n\r\n                const response = await fetch('/api/push/test', {\r\n                    method: 'POST',\r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                        'Accept': 'application/json',\r\n                        'X-CSRF-TOKEN': document.querySelector('meta[name=\"csrf-token\"]')?.content || ''\r\n                    },\r\n                    credentials: 'same-origin'\r\n                });\r\n\r\n                const data = await response.json();\r\n                \r\n                if (data.success) {\r\n                    alert('Test notification sent! Check your device for the notification.');\r\n                    console.log('[PushWidget] Test notification sent successfully');\r\n                } else {\r\n                    alert('Error: ' + (data.error || data.message || 'Failed to send test notification'));\r\n                    console.error('[PushWidget] Test notification failed:', data);\r\n                }\r\n            } catch (error) {\r\n                console.error('[PushWidget] Failed to send test notification:', error);\r\n                alert('Failed to send test notification. Please try again.');\r\n            } finally {\r\n                if (this.controls.testNotificationBtn) {\r\n                    this.controls.testNotificationBtn.disabled = false;\r\n                    this.controls.testNotificationBtn.innerHTML = `\r\n                        <svg class=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9\"></path>\r\n                        </svg>\r\n                        Send Test Notification\r\n                    `;\r\n                }\r\n            }\r\n        }\r\n    };\r\n}\r\n\r\n// Export to global scope for Alpine.js\r\nwindow.pushNotificationWidget = pushNotificationWidget;\r\n\r\n// Also export sendTestNotification to global scope for onclick handler\r\nwindow.sendTestNotification = function() {\r\n    const widget = document.querySelector('#push-notification-manager');\r\n    if (widget && widget._x_dataStack) {\r\n        const widgetData = widget._x_dataStack[0];\r\n        if (widgetData && widgetData.sendTestNotification) {\r\n            widgetData.sendTestNotification();\r\n        }\r\n    }\r\n};\r\n"],"names":["pushNotificationWidget","widgetContainer","el","element","base64String","padding","base64","rawData","outputArray","_a","registration","error","_","reject","permission","subscription","response","errorText","responseData","data","widget","widgetData"],"mappings":"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"}